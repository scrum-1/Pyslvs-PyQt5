#Travis-Ci
dist: trusty
sudo: required
language: python

python:
- 3.4
- 3.5
- 3.6

branches:
  only:
    - master
    - /^dev\d*[.]?\d*$/

before_install:
  #SWIG
  - sudo apt -y install swig
  #SIP
  - cd ..
  - curl -L -O "https://sourceforge.net/projects/pyqt/files/sip/sip-4.19.3/sip-4.19.3.tar.gz"
  - tar -xvf sip-4.19.3.tar.gz
  - cd sip-4.19.3
  - python configure.py
  - sudo make install
  #Qt5
  - sudo add-apt-repository -y "ppa:beineri/opt-qt59-trusty"
  - sudo apt-get update -qq
  - sudo apt-get install qt59-meta-full qt59charts-no-lgpl
  - QTDIR="/opt/qt59"
  - PATH="$QTDIR/bin:$PATH"
  - source /opt/qt59/bin/qt59-env.sh
  - qmake -v
  #PyQt5
  - cd ..
  - curl -L -O "https://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.9/PyQt5_gpl-5.9.tar.gz"
  - tar -xvf PyQt5_gpl-5.9.tar.gz
  - cd PyQt5_gpl-5.9
  - python configure.py --confirm-license
  - sudo make install
  #QScintilla
  - cd ..
  - curl -L -O "https://sourceforge.net/projects/pyqt/files/QScintilla2/QScintilla-2.10.1/QScintilla_gpl-2.10.1.tar.gz"
  - tar -xvf QScintilla_gpl-2.10.1.tar.gz
  - cd QScintilla_gpl-2.10.1
  - cd Qt4Qt5
  - qmake qscintilla.pro
  - sudo make install
  - cd ../designer-Qt4Qt5
  - qmake designer.pro
  - sudo make install
  - cd ../Python
  - python configure.py --pyqt=PyQt5
  - sudo make install
  #PyQtChart
  - cd ../..
  - curl -L -O "https://sourceforge.net/projects/pyqt/files/PyQtChart/PyQtChart-5.9/PyQtChart_gpl-5.9.tar.gz"
  - tar -xvf PyQtChart_gpl-5.9.tar.gz
  - cd PyQtChart_gpl-5.9
  - python configure.py
  - sudo make install
  - cd $TRAVIS_BUILD_DIR

install:
  - pip install -r requirements.txt
  - pip install "https://github.com/pyinstaller/pyinstaller/archive/develop.zip"

script:
 - make

before_cache:
  - rm -rf $HOME/.cache/pip/log
cache:
  directories:
    - $HOME/.cache/pip
